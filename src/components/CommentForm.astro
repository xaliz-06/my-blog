---
import { isInputError, actions } from 'astro:actions';
import { Input } from './ui/input';
import { Textarea } from './ui/textarea';
import { Button } from './ui/button';

interface Props {
    postSlug: string;
}

const { postSlug } = Astro.props;

const result = Astro.getActionResult(actions.addComment);
const inputErrors = isInputError(result?.error) ? result.error.fields : {};
---

<form method="POST" action={actions.addComment} class="mb-8 font-roboto-mono">
  <input type="hidden" name="postSlug" value={postSlug} />

  <div class="flex w-full flex-row mb-4 space-x-8 justify-center items-center">
    <div class="flex-1 flex flex-col space-y-4">
      <label for="username" class="text-xl font-semibold tracking-tight">Name:</label>
      <Input
          className="w-full h-[50px] bg-purple-400 border-black border-4 px-6 text-2xl font-bold focus:outline-none focus:ring-0 focus:border-black focus-visible:outline-none focus-visible:ring-0 focus-visible:border-black relative shadow-[5px_5px_0px_0px_#000] focus-visible:-translate-x-2 focus-visible:-translate-y-2 focus-visible:shadow-[8px_8px_0px_0px_#000] transition-all duration-300 ease-in-out"
          type="text"
          id="username"
          name="username"
          required
          placeholder="Name or Nickname"
        />
      {inputErrors.username &&
      <p class="text-red-500">{inputErrors.username}</p>
      }
    </div>

    <div class="flex-1 flex flex-col space-y-4">
      <label for="email" class="text-xl font-semibold tracking-tight">Email:</label>
      <Input
          className="w-full h-[50px] bg-purple-400 border-black border-4 px-6 text-2xl font-bold focus:outline-none focus:ring-0 focus:border-black focus-visible:outline-none focus-visible:ring-0 focus-visible:border-black relative shadow-[5px_5px_0px_0px_#000] focus-visible:-translate-x-2 focus-visible:-translate-y-2 focus-visible:shadow-[8px_8px_0px_0px_#000] transition-all duration-300 ease-in-out"
          type="text"
          id="email"
          name="email"
          placeholder="E-mail (optional)"
        />
      {inputErrors.email &&
      <p class="text-red-500">{inputErrors.email}</p>
      }
    </div>
  </div>

  <div class="mb-4 flex-1 flex flex-col space-y-4">
    <label for="message" class="text-xl font-semibold tracking-tight">Comment:</label>
    <Textarea
      id="message"
      name="message"
      required
      className="w-full h-[100px] bg-purple-400 border-black border-4 px-6 text-2xl font-bold focus:outline-none focus:ring-0 focus:border-black focus-visible:outline-none focus-visible:ring-0 focus-visible:border-black relative shadow-[5px_5px_0px_0px_#000] focus-visible:-translate-x-2 focus-visible:-translate-y-2 focus-visible:shadow-[8px_8px_0px_0px_#000] transition-all duration-300 ease-in-out"
      placeholder='Write your comment here...'
    />
    { inputErrors.message && (
    <p class="text-red-500">{inputErrors.message}</p>
    ) }
  </div>
  
  <div class="mt-6 mb-12">
    <Button
      variant="outline"
      className="w-[20%] h-[55px] rounded-none border-orange-400 border-4 cursor-pointer bg-orange-400 -translate-x-1 -translate-y-1 transition-all duration-300 ease-in-out text-white shadow-[5px_5px_0px_0px_#000] shadow-black relative hover:-translate-x-2 hover:-translate-y-2 hover:shadow-[8px_8px_0px_0px_#000] hover:shadow-black hover:bg-indigo-500 hover:border-indigo-500 hover:text-white"
      type='submit'
    >
      <div class="flex gap-2 items-center justify-center">
        <h5 class="text-2xl font-semibold tracking-tighter">
          ADD COMMENT
        </h5>
      </div>
    </Button>
  </div>
</form>